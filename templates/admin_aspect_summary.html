<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Aspect Summary â€” MessVote</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>

<body>

    {% include '_header.html' %}

    <!-- âœ… PAGE WRAPPER (THIS FIXES CENTERING) -->
    <div class="page-wrapper">
        <div class="choose-card" style="width:650px">

            <h1 class="main-heading">
                What Students Are Complaining About
            </h1>

            {% if aspect_data %}

                <!-- Aspect Table -->
                <table style="width:100%; margin-top:25px; border-collapse: collapse;">
                    <thead>
                        <tr style="background:#222; color:white">
                            <th style="padding:12px">Aspect</th>
                            <th style="padding:12px">Complaints</th>
                            <th style="padding:12px">Percentage</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for row in aspect_data %}
                            <tr style="text-align:center; border-bottom:1px solid #ccc">
                                <td style="padding:12px">{{ row.aspect | title }}</td>
                                <td style="padding:12px">{{ row.total }}</td>
                                <td style="padding:12px">{{ row.percentage }}%</td>
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>

                <!-- Sentiment Breakdown -->
                <h3 style="margin-top:35px; font-size:20px; font-weight:700;">
                    Sentiment Breakdown by Aspect
                </h3>

                {% for aspect in sentiment_data %}

                    <div style="
                        margin-top:20px;
                        padding:15px;
                        background:#ffffffaa;
                        border-radius:12px;
                    ">

                        <div style="display:flex; justify-content:space-between;">
                            <strong style="font-size:16px;">
                                {{ aspect.title() }}
                            </strong>
                        </div>

                        {% set neg = sentiment_data[aspect]['negative'] %}
                        {% set neu = sentiment_data[aspect]['neutral'] %}
                        {% set pos = sentiment_data[aspect]['positive'] %}

                        <div class="sentiment-container" style="margin-top:5px;">
                            <div class="neg-bar" style="width: {{ neg }}%;"></div>
                            <div class="neu-bar" style="width: {{ neu }}%;"></div>
                            <div class="pos-bar" style="width: {{ pos }}%;"></div>
                        </div>

                        <div style="margin-top:6px; font-size:13px;">
                            ğŸ”´ {{ neg }}% negative |
                            ğŸŸ¡ {{ neu }}% neutral |
                            ğŸŸ¢ {{ pos }}% positive
                        </div>

                    </div>

                {% endfor %}

                <!-- Students Say Summary -->
                <div style="
                    margin-top:30px;
                    padding:20px;
                    border-radius:16px;
                    background: linear-gradient(135deg, #FFD8B1, #fbd5ac);
                    box-shadow: 0 10px 30px rgba(0,0,0,0.15);
                ">
                    <h3 style="
                        margin-bottom:10px;
                        color:#1f1f1f;
                        font-weight:700;
                    ">
                        What Students Say
                    </h3>

                    <p style="
                        color:#2a2a2a;
                        line-height:1.6;
                        font-size:15px;
                        margin:0;
                    ">
                        {{ student_summary }}
                    </p>
                </div>

            {% else %}

                <p style="margin-top:20px;">
                    No feedback data yet.
                </p>

            {% endif %}

            <a href="{{ url_for('admin_dashboard') }}" class="btn" style="margin-top:25px">
                â† Back to Dashboard
            </a>

        </div>
    </div>

    {% include '_footer.html' %}

</body>

</html>
